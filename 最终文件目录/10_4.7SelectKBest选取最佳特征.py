# -*- codeing = utf-8 -*-
# @Time : 2025/4/7 9:59
# @Author : 星空噩梦
# @File ： 10_4.7SelectKBest选取最佳特征.py
# @Software : PyCharm
# 导入所需的库
import matplotlib
import numpy as np
import pandas as pd
from sklearn.feature_selection import SelectKBest, mutual_info_classif,f_classif,chi2
matplotlib.use('TkAgg')
import matplotlib.pyplot as plt


CONSISTENT3=[0.24972165984443295, 0.2047441294424624, 0.03047416967654091, 0.6746931165822778, 0.11076337736553085, 0.23341867789766232, 0.2537166031849363, 0.6273903387223303, 0.1749474840398871, 0.7599945819467698, 0.20089527892569153, 1.2025042140038729, 1.6898599475320697, 0.19103448349776464, 0.6888410363651325, 0.2240819212890958, 0.3918211808527724, 0.4296356547120696, 0.1910328429062601, 0.31086403614547686, 0.38913449727094473, 0.1816920864025837, 0.38887250095649567, 0.23512492201111151, 0.8402414124476029, 0.5005396805242605, 0.37900774530581066, 1.5658448255410171, 0.9025406019171096, 0.7460314185623221, 0.9108494457121038, 0.6932037434136195, 0.25018766989408997, 0.804951556995988, 0.4604143094447313, 0.40545755573588643, 0.1166700563285829, 0.7034367615153411, 1.7296970340531341, 0.7709244828027606, 0.5903755612485277, 1.40369670371033, 1.7322502680070793, 0.9138435861476734, 1.0952364320758377, 0.09833056169227514, 0.2709111824221231, 0.7809332388952069, 0.43222349156781315, 0.6391336938091566, 0.8666539738023985, 0.4332629850079932, 0.49561877816901095, 1.7914233881934485, 0.4924580735688011, 1.0643086811406668, 1.3253685209356665, 0.4803810296553019]
NONCONSISTENT3=[1.4494513058442218, 0.8065684353106842, 0.30346596673356613, 0.6767351593002264, 0.5545913580197896, 1.1529167326156597, 0.5555151820233531, 1.5249735977310477, 1.5487847849999812, 1.3940889580830598, 1.4291111483158223, 0.9590427930195667, 0.3118083131433907, 1.066335963916815, 0.4938058438940244, 0.2998097709883633, 0.25922830362621485, 0.42685966115892154, 0.6474465391120412, 0.569961754323222, 0.4639873376954698, 0.7640639937327747, 1.0009983461421725, 1.3113765998470646, 0.9315344588983562, 0.46371338645596105, 1.1507974529090155, 0.36765927666673615, 1.2412884363556114, 1.358369443159525, 1.451596318625435, 0.9502424444697006, 1.5532179918188198, 1.3084096017538867, 1.5159357900750903, 0.966728527973014, 0.2980263929989868, 0.40771237261041293, 0.49694032627285856, 1.2179465317982618, 1.0871082900229487, 1.2100022755219797, 0.13527634974738656, 0.6321591869534112, 1.3164638337924786, 0.6024827113761075, 1.3295875904704262, 1.024703086276257, 1.2560085862349577, 1.1257979302647376, 0.442767833438548, 0.9882998083826459, 1.1144716350818984, 0.07000112009846324, 0.25108811051325036, 1.2850836280893754, 1.0301397914482475, 1.0495043625616178, 0.9057863750745987, 0.08272937348796831, 0.5876171029835178, 0.3805439629257098]
CONSISTENT2=[0.31308307572197885, 0.26612706915959433, 0.04047960813049956, 0.7701676368351767, 0.14384311210268844, 0.30125158106537775, 0.3253932630701998, 0.7129309354655449, 0.2235970072951945, 0.8914867528301482, 0.26111061896581017, 1.2865734604518826, 1.755593361831013, 0.24316301811488206, 0.7859334515650664, 0.28795580123631676, 0.491902055147854, 0.5307020555987744, 0.24872050236924348, 0.3931579593522074, 0.47348114127650726, 0.23182102652070946, 0.4695592788089381, 0.3001824483186022, 0.9595532556517844, 0.5939718922410515, 0.4604030621599265, 1.6745371788543344, 1.0453453407978788, 0.8101162176587585, 1.0217969063815215, 0.7652679383854145, 0.32235607054830756, 0.8612054407851186, 0.5710080029896282, 0.5056091954916204, 0.1515013508478912, 0.7770221045108353, 1.8062517744688174, 0.8557825423825083, 0.7125014608140269, 1.4606861742595585, 1.8185963297013785, 0.9476432937110012, 1.2166195672628142, 0.12842063976411544, 0.34545013600130264, 0.9505602074822679, 0.5495665904452625, 0.7908939970424115, 0.9780693111863216, 0.5327791583965477, 0.5826643768691704, 1.927319352611958, 0.6259301325903782, 1.1050482912669497, 1.4585682662409751, 0.6117292382286569]
NONCONSISTENT2=[1.5200898791150255, 0.961187018978735, 0.375083046114627, 0.8379161961471745, 0.6964723930523412, 1.2623112175168485, 0.6997208256074369, 1.6578671442953428, 1.6056510375667026, 1.4842114555507946, 1.4787816099983433, 0.9740167531299684, 0.3895600329123393, 1.1323764751155598, 0.6018115161632072, 0.3709272891484973, 0.3273526875281813, 0.5177657295072468, 0.7248874435157202, 0.6925805417559624, 0.5867845234310443, 0.9071056972149573, 1.0531631343251924, 1.3807213980075486, 1.0440303009407976, 0.5753693754454727, 1.1886049388026663, 0.47109171080929774, 1.358647751788315, 1.4306969928211477, 1.610906478271872, 1.091136660888121, 1.6849091952663862, 1.393242486798315, 1.6088665613574222, 1.14060984709955, 0.37006377998416196, 0.5053856418667833, 0.5867433166443211, 1.2963753268334748, 1.2542079556701384, 1.33229231725331, 0.17461934158870987, 0.7822900997568292, 1.3751789698430648, 0.7050638617151646, 1.4474845980821525, 1.0471169683878327, 1.4358311012570562, 1.1596180808497585, 0.5559292230960075, 1.1256613404047728, 1.2562683345462984, 0.09204103466181475, 0.3244958026080954, 1.3612015265799111, 1.212160285867487, 1.199565229425119, 1.0387177489582058, 0.10921175498243159, 0.7159694711532093, 0.4855192088599734]
CONSISTENT1=[0.49852348618564224, 0.5279578391166615, 0.12268354096022835, 0.9691574975819941, 0.2861493985284232, 0.5878964923001518, 0.5946574994084305, 0.8756389615630379, 0.3945446839165707, 1.1511900123504222, 0.5193872294717614, 1.4365525507801808, 1.8559197128699079, 0.4186455640432426, 0.9886112882856176, 0.5503308755797172, 0.826603650871921, 0.8143284319930955, 0.5021499955996597, 0.6681616442224102, 0.6908396487002174, 0.4047782480915695, 0.6500869263938048, 0.5416147551794468, 1.1932344792848033, 0.8110025361053572, 0.6610429258481247, 1.904833288839223, 1.2981357194306837, 0.8960027237013213, 1.243827149027955, 0.8684996485508671, 0.6194229360706671, 0.9466109068193388, 0.8749457753693282, 0.7994755433273187, 0.30601912974361223, 0.8965974239331774, 1.8973833258025543, 1.0457964628229663, 1.0470105609775118, 1.5225908055095974, 1.9724423575843648, 1.009529222394789, 1.4987881529437883, 0.27686869285582694, 0.6355731033228627, 1.3365910624176747, 0.9427307436599598, 1.186100383716192, 1.1881544181968866, 0.8191784879374873, 0.7627027618344063, 2.1088792233350775, 1.0465215249661088, 1.2132569621162943, 1.6799706929702203, 1.0449805515984374]
NONCONSISTENT1=[1.637267847742275, 1.3280001736677982, 0.5625045117119263, 1.2471726107531502, 1.1062107095869647, 1.4329436870881267, 1.1516822479326692, 1.8880186625532938, 1.7107167823753917, 1.6856657898331215, 1.5482388861677228, 0.9982103257364935, 0.6397829169819957, 1.318909590278643, 0.8816212095339779, 0.558391605796748, 0.5570485506677776, 0.7534214013530225, 0.8426430301401722, 0.9873957949950698, 0.9786251450940882, 1.1821245832692306, 1.1867205238568366, 1.5584489314245564, 1.2442514384975372, 0.8813127596539225, 1.2921247671518155, 0.8561749475356071, 1.5422103776996725, 1.5924076898232251, 1.8856289481611643, 1.380740616146449, 1.842657730308862, 1.6446824309020727, 1.7585642796121341, 1.5385469385109811, 0.5758946634905077, 0.7868404148736774, 0.7849131771648769, 1.430683756064059, 1.5476630382885856, 1.5609494755263698, 0.3301448111743118, 1.1791103581199651, 1.517684623709279, 0.9554879883512305, 1.6411707842284713, 1.1231734008222984, 1.703493340489444, 1.279323919212311, 0.8996692919911262, 1.4154916751883353, 1.5112330438100092, 0.21675371892890088, 0.6367129843802664, 1.511359212558339, 1.5519613931882816, 1.492580142811422, 1.3084467754033802, 0.2679462397071572, 1.0183793201647986, 0.8493989854732277]
CONSISTENT0_5=[0.7001096199783154, 0.9268743912329088, 0.48526780872839986, 1.1842624943497866, 0.5217032771208829, 1.1077927414413482, 0.9698602250016666, 1.0670644400776426, 0.6190459262676399, 1.3497665466571125, 0.9179766836114147, 1.6296277997940007, 1.922455804647939, 0.6387433083696098, 1.2027433838697301, 1.011438966765209, 1.2737382259703978, 1.1236745223701992, 0.9034107583757748, 1.0191237369982165, 0.9610148208948259, 0.6274837276135914, 0.80356240334307, 0.9023593563861194, 1.421356869278847, 1.0627129952369434, 0.9040748157956888, 2.0915759716715585, 1.5138596834715632, 0.9463562387790649, 1.479325387550297, 0.9315811889735047, 1.1020743690325698, 1.0636898515715125, 1.1791269461038825, 1.1214420067056263, 0.611668358840372, 1.0386658497596928, 1.947605825435473, 1.328208778350472, 1.4817049661785506, 1.5540221123496933, 2.1072508185398178, 1.12486394012661, 1.8119363352658893, 0.6056225380113391, 1.14879659928165, 1.6466423841281035, 1.3963973178473132, 1.5498618019645864, 1.3592398056124573, 1.1949287487528815, 0.9666049869810164, 2.2134708047381064, 1.479553212098348, 1.345213845224787, 1.8307238633890988, 1.5475286559141899]
NONCONSISTENT0_5=[1.7594505464414743, 1.7009685056683947, 0.7455960066453228, 1.599260940237895, 1.508107396050865, 1.592693900506629, 1.6539156054480153, 2.073289197738956, 1.8166428342164058, 1.9116168531380535, 1.6367820059785663, 1.0642365270142418, 1.032417732276375, 1.5641315023079592, 1.1682225761500842, 0.7427578997228911, 0.8900231020787448, 1.0352251384451943, 0.9174467710317027, 1.250872325823876, 1.4156454977536503, 1.3757101439447046, 1.3974015479520694, 1.7371017127918857, 1.3959063606774977, 1.1846569153473268, 1.4042787222954272, 1.386592550531207, 1.7048518986712733, 1.7515579914658799, 2.08545944401679, 1.6383089065749987, 1.923320241727174, 1.9219127785916845, 1.8662900377483442, 1.8887373699179903, 0.8492382906656776, 1.1030341185324382, 1.0174164674531363, 1.573474949667211, 1.7557507038714464, 1.813794672157363, 0.5631491598130747, 1.5478951617912207, 1.682658267791223, 1.2906503416369446, 1.8342361211851246, 1.255663750381533, 1.854875286574586, 1.475249066380532, 1.3052289120881417, 1.6692818395769402, 1.7170348408799612, 0.5413992979613592, 1.1837552666918614, 1.7113349710882562, 1.8176288676751864, 1.7224230385625265, 1.5665819575109121, 0.6543331954934709, 1.275599045058865, 1.3063231874199646]
CONSISTENT0_7=[0.6075543793132625, 0.7330047408098688, 0.26217456872870337, 1.0816626732653656, 0.40336546887087726, 0.8374818970093026, 0.7896159495748635, 0.9701039627429482, 0.51178375558651, 1.2648794062250936, 0.7235719241110588, 1.5271662442361484, 1.8944698644985176, 0.5346122793753135, 1.1015152587076094, 0.7745952525546506, 1.059458193380426, 0.981199050565064, 0.7066829540117775, 0.8526576730521255, 0.8271188840005111, 0.5215273473372234, 0.7364596767672948, 0.7241467474745822, 1.3120295738725054, 0.9401676127090279, 0.7821049955091783, 2.0107715615521995, 1.4129187883860173, 0.9257273786311302, 1.3654712729077763, 0.9055659838663663, 0.8612394492507318, 0.9991366278456352, 1.0427733467874456, 0.9738964466804205, 0.44746877686002445, 0.9634347955941972, 1.9272079365971104, 1.1826520423019355, 1.2684978208748747, 1.5414750461296227, 2.045996558279413, 1.0602066512389312, 1.6648422871315371, 0.42661111476997726, 0.882271199630216, 1.5144046441017587, 1.1895856332630317, 1.3902896426877367, 1.284253923244518, 1.0094934248966596, 0.8636160033784049, 2.170888728116256, 1.2880125377739748, 1.28207932296699, 1.7675350219058004, 1.3153218823671162]
NONCONSISTENT0_7=[1.7008928372803573, 1.5282883524736877, 0.6633391436685052, 1.448022543785764, 1.3308283736178521, 1.5149022190374317, 1.425832498015792, 1.9918403845858081, 1.7671462454745088, 1.8039931741324087, 1.5889396166697496, 1.0227875960635808, 0.829687591668422, 1.4457028686523756, 1.0376241090963418, 0.65981685941087, 0.7241443801129673, 0.8988710535048554, 0.886400363149104, 1.135144545655106, 1.2171263819289901, 1.294925138389679, 1.2873657642884926, 1.6558793685984352, 1.3305388896201416, 1.0490580059679462, 1.352288913377756, 1.1315766858624794, 1.6291480141812433, 1.6786514977518903, 2.000339489200967, 1.5231979659875392, 1.8913317042109419, 1.794809998682564, 1.8201212482916604, 1.7355392330516968, 0.7113493993790015, 0.9564380602503678, 0.9017992905580777, 1.501827344034524, 1.6675978266857168, 1.6909595084359916, 0.44861143362391964, 1.3861230279413328, 1.6034373935845143, 1.1230339395576703, 1.74020901222769, 1.18709569192152, 1.7942826186309875, 1.3737989323080066, 1.1138768984205796, 1.5573256026793136, 1.6263000257622025, 0.35949662960589, 0.9040337662687027, 1.6074216338335032, 1.698752724034511, 1.6234966573906593, 1.4472594676228976, 0.44561106752625246, 1.164194653399408, 1.0919950945017503]



# 将每个列表转换为 numpy 数组（假设每个数组形状为 (n,)）
cons3 = np.array(CONSISTENT3)
noncons3 = np.array(NONCONSISTENT3)
cons2 = np.array(CONSISTENT2)
noncons2 = np.array(NONCONSISTENT2)
cons1 = np.array(CONSISTENT1)
noncons1 = np.array(NONCONSISTENT1)
cons0_5 = np.array(CONSISTENT0_5)
noncons0_5 = np.array(NONCONSISTENT0_5)
cons0_7 = np.array(CONSISTENT0_7)
noncons0_7 = np.array(NONCONSISTENT0_7)

# 组装 CONSISTENT 类的数据（每一行为一个样本，列为各个参数）
X_consistent = np.column_stack((cons3, cons2, cons1, cons0_5, cons0_7))
# 组装 NONCONSISTENT 类的数据
X_nonconsistent = np.column_stack((noncons3, noncons2, noncons1, noncons0_5, noncons0_7))

# 合并两个类别的数据，得到最终的特征矩阵 X
X = np.vstack((X_consistent, X_nonconsistent))

# 构建标签 y：假设用 1 表示 CONSISTENT，0 表示 NONCONSISTENT
n = cons3.shape[0]  # 每个列表的长度
m = noncons3.shape[0]  # 每个列表的长度
y = np.array([1] * n + [0] * m)



# 假设你的 X 和 y 已经准备好
# X: (n_samples, n_features)，连续型特征数据
# y: (n_samples, )，二分类标签（0 或 1）

# 示例数据（可以替换为你自己的 X 和 y）
# X = np.random.rand(100, 5)  # 100个样本，5个特征
# y = np.random.choice([0, 1], size=100)  # 随机生成0/1标签

# 计算所有特征的互信息分数
selector = SelectKBest(score_func=mutual_info_classif, k='all')
selector.fit(X, y)

# 获取每个特征的互信息得分
scores = selector.scores_

# # 假设你的特征有名称，如果没有可以直接使用 'Feature1', 'Feature2' 等
# feature_names = [f'Feature{i+1}' for i in range(X.shape[1])]  # 生成特征名称
#
# # 将得分与特征名称合并成一个 DataFrame，按得分降序排列
# score_table = pd.DataFrame({
#     'Feature': feature_names,
#     'Score': scores
# }).sort_values(by='Score', ascending=False)

feature_names = ['α=3', 'α=2', 'α=1', 'α=0.5', 'α=0.7']

# 将得分与特征名称合并成一个 DataFrame，保持指定顺序
score_table = pd.DataFrame({
    'Feature': feature_names,
    'Score': scores
}).sort_values(by='Score', ascending=False)

# 输出特征得分
print(score_table)

# 可视化特征得分（条形图）
plt.figure(figsize=(10, 6))
score_table.plot(kind='bar', x='Feature', y='Score', legend=False, color='skyblue')
plt.xlabel("α Value")
plt.ylabel("Score")
plt.title("Feature Scores of Renyi Entropy for Different α Values")
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()